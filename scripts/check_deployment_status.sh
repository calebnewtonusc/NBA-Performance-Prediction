#!/bin/bash
# Check NBA Performance Prediction Deployment Status

PROJECT_ID="502c137a-1a48-4903-a396-6ecf23965758"
GITHUB_REPO="https://github.com/calebnewtonusc/NBA-Performance-Prediction"

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ðŸ“Š NBA Performance Prediction - Deployment Status"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# Check GitHub
echo "âœ… GitHub Repository"
echo "   â””â”€ $GITHUB_REPO"
if curl -sf "$GITHUB_REPO" > /dev/null 2>&1; then
    echo "   â””â”€ Status: Live âœ“"
else
    echo "   â””â”€ Status: Cannot verify (may be rate limited)"
fi
echo ""

# Check Railway
echo "âœ… Railway Project"
echo "   â””â”€ Project: insightful-heart"
echo "   â””â”€ URL: https://railway.com/project/$PROJECT_ID"
echo "   â””â”€ PostgreSQL: Provisioned âœ“"
echo "   â””â”€ Redis: Provisioned âœ“"
echo "   â””â”€ Environment Variables: Set âœ“"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ðŸŽ¯ WHAT'S DONE (100% Automated)"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "âœ“ GitHub repository created and code pushed"
echo "âœ“ Railway project created"
echo "âœ“ PostgreSQL database added"
echo "âœ“ Redis cache added"
echo "âœ“ All environment variables configured"
echo "âœ“ Production secrets generated"
echo "âœ“ CI/CD pipeline fixed and active"
echo "âœ“ Complete documentation created"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â³ WHAT YOU NEED TO DO (Web UI Required)"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Unfortunately, Railway & Streamlit require web UI for:"
echo "  â€¢ Connecting GitHub repo to Railway service"
echo "  â€¢ Generating domains"
echo "  â€¢ Creating Streamlit apps"
echo ""
echo "âš ï¸  Railway CLI Limitation:"
echo "   The Railway CLI can't automatically connect your GitHub"
echo "   repo as a service. This must be done via web UI."
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ðŸ“‹ COMPLETE THESE 3 STEPS (5 minutes)"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "1ï¸âƒ£  RAILWAY: Connect GitHub Repo (2 minutes)"
echo ""
echo "   a. Open: https://railway.com/project/$PROJECT_ID"
echo "   b. Click '+ New' button"
echo "   c. Select 'GitHub Repo'"
echo "   d. Choose: calebnewtonusc/NBA-Performance-Prediction"
echo "   e. Railway auto-detects Dockerfile.api âœ“"
echo "   f. Wait for build (~2-3 minutes)"
echo "   g. Go to Settings â†’ Networking â†’ 'Generate Domain'"
echo "   h. Copy the URL"
echo ""
echo "2ï¸âƒ£  STREAMLIT: Deploy Dashboard (3 minutes)"
echo ""
echo "   a. Open: https://share.streamlit.io"
echo "   b. Click 'New app'"
echo "   c. Repository: calebnewtonusc/NBA-Performance-Prediction"
echo "   d. Branch: main"
echo "   e. Main file: src/visualization/dashboard.py"
echo "   f. Advanced settings â†’ Secrets â†’ Paste:"
echo ""
echo "      API_BASE_URL = \"https://YOUR-RAILWAY-URL.up.railway.app\""
echo "      API_USERNAME = \"admin\""
echo "      API_PASSWORD = \"G9.zs8FGHP1W_lx^5eP,}mU2\""
echo ""
echo "   g. Click 'Deploy!'"
echo "   h. Wait 2-3 minutes"
echo "   i. Copy your Streamlit URL"
echo ""
echo "3ï¸âƒ£  RAILWAY: Update CORS (30 seconds)"
echo ""
echo "   a. Back in Railway â†’ Your API service â†’ Variables"
echo "   b. Update ALLOWED_ORIGINS to:"
echo "      https://YOUR-STREAMLIT-URL.streamlit.app,http://localhost:8501"
echo "   c. Service auto-redeploys"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ðŸš€ AFTER COMPLETION"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Your live system will have:"
echo "  â€¢ FastAPI backend with JWT auth"
echo "  â€¢ PostgreSQL database"
echo "  â€¢ Redis caching"
echo "  â€¢ Streamlit dashboard"
echo "  â€¢ API documentation (Swagger UI)"
echo "  â€¢ Prometheus metrics"
echo "  â€¢ CI/CD pipeline"
echo ""
echo "Cost: \$10-15/month"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ðŸ“š HELPFUL RESOURCES"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Open these files for detailed instructions:"
echo "  â€¢ AUTOMATED_SETUP_COMPLETE.md (quick guide)"
echo "  â€¢ DEPLOYMENT_STATUS.md (detailed checklist)"
echo "  â€¢ DEPLOYMENT_SECRETS.txt (all passwords)"
echo "  â€¢ docs/DEPLOYMENT.md (complete reference)"
echo ""
echo "Test scripts:"
echo "  â€¢ python3 scripts/test_api_connection.py"
echo "  â€¢ python3 scripts/generate_secrets.py"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ðŸŽ¯ OPEN DASHBOARDS NOW"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
read -p "Press Enter to open Railway and Streamlit dashboards..."

open "https://railway.com/project/$PROJECT_ID" 2>/dev/null || \
  echo "Open manually: https://railway.com/project/$PROJECT_ID"

sleep 1

open "https://share.streamlit.io" 2>/dev/null || \
  echo "Open manually: https://share.streamlit.io"

echo ""
echo "âœ… Dashboards opened! Follow the 3 steps above."
echo ""
